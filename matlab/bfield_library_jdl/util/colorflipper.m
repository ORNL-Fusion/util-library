function cf = colorflipper(num_colors,cmap)
% cf = colorflipper(num_colors,cmap)
% cf(num_colors,3)
% Available options for cmap:
%'jet'
%'jet_to_white'
%'jet_white_last'
%'rainbow_to_white'
%'rainbow_white_last'
%'parula'
%'hsv'
%'cw'  -- cool warm
%'rb'
%'blues'
%'morgan'
%'rainbow'
%'magma'
%'magma_to_white'
%'plasma_to_white'
%'plasma'
%'matlab_lines'
%'tab20'
%'viridis'

if nargin < 1
    num_colors = [];
end
if nargin < 2
    cmap = 'jet';
end

switch lower(cmap)
    case {'jet'}
        if isempty(num_colors)
            num_colors = 64;
        end
        cf = jet(num_colors);
        return;
    case {'jet_to_white'}
        cf = cmap_jet_to_white(num_colors);
        return;
    case {'jet_white_last'}
        cf = cmap_jet_to_white(num_colors,1);
        return;        
    case {'rainbow_to_white'}
        cf = cmap_rainbow_to_white(16);
    case {'rainbow_white_last'}
        cf = cmap_rainbow_to_white(1);        
    case {'parula'}
        cf = parula(num_colors);
        return;
    case {'hsv'}
        cf = hsv(num_colors);
        return;
    case {'cw'}
        cf = cmap_cw;
    case {'rb'}
        cf = cmap_rb;
    case {'blues'}
        cf = cmap_blues;
    case {'morgan'}
        cf = cmap_morgan;
    case {'rainbow'}
        cf = cmap_rainbow;
    case {'magma'}
        cf = cmap_magma;
    case {'magma_to_white'}
        cf = cmap_magma_to_white(16);
    case {'plasma_to_white'}
        cf = cmap_plasma_to_white(3);        
    case {'plasma'}
        cf = cmap_plasma;
    case {'matlab_lines'}
        cf = matlab_lines(num_colors);
    case {'tab20'}
        cf = cmap_tab20;                
    case {'viridis'}
        cf = viridis(num_colors);
    otherwise
        cf = matlab_lines;
        return;
end

if ~isempty(num_colors)
    cf = interpolate_cf(cf,num_colors);
end

end

function cmap = matlab_lines(num_colors)
cmap = [...
                   0   0.447000000000000   0.741000000000000
   0.850000000000000   0.325000000000000   0.098000000000000
   0.929000000000000   0.694000000000000   0.125000000000000
   0.494000000000000   0.184000000000000   0.556000000000000
   0.466000000000000   0.674000000000000   0.188000000000000
   0.301000000000000   0.745000000000000   0.933000000000000
   0.635000000000000   0.078000000000000   0.184000000000000
];
nrep = ceil(num_colors/size(cmap,1));
cmap = repmat(cmap,nrep,1);
end

function cf2 = interpolate_cf(cf,n)
index = linspace(1,size(cf,1),n);
cf2 = zeros(n,3);
cf2(:,1) = interp1(1:size(cf,1),cf(:,1),index);
cf2(:,2) = interp1(1:size(cf,1),cf(:,2),index);
cf2(:,3) = interp1(1:size(cf,1),cf(:,3),index);
end

function cmap = viridis(N)
cmap = [0.267004,0.004874,0.329415; 
    0.268510,0.009605,0.335427; 0.269944,0.014625,0.341379; 0.271305,0.019942,0.347269; 0.272594,0.025563,0.353093; 
    0.273809,0.031497,0.358853; 0.274952,0.037752,0.364543; 0.276022,0.044167,0.370164; 0.277018,0.050344,0.375715; 
    0.277941,0.056324,0.381191; 0.278791,0.062145,0.386592; 0.279566,0.067836,0.391917; 0.280267,0.073417,0.397163; 
    0.280894,0.078907,0.402329; 0.281446,0.084320,0.407414; 0.281924,0.089666,0.412415; 0.282327,0.094955,0.417331; 0.282656,0.100196,0.422160; 
    0.282910,0.105393,0.426902; 0.283091,0.110553,0.431554; 0.283197,0.115680,0.436115; 0.283229,0.120777,0.440584; 0.283187,0.125848,0.444960; 
    0.283072,0.130895,0.449241; 0.282884,0.135920,0.453427; 0.282623,0.140926,0.457517; 0.282290,0.145912,0.461510; 0.281887,0.150881,0.465405; 
    0.281412,0.155834,0.469201; 0.280868,0.160771,0.472899; 0.280255,0.165693,0.476498; 0.279574,0.170599,0.479997; 0.278826,0.175490,0.483397; 
    0.278012,0.180367,0.486697; 0.277134,0.185228,0.489898; 0.276194,0.190074,0.493001; 0.275191,0.194905,0.496005; 0.274128,0.199721,0.498911; 
    0.273006,0.204520,0.501721; 0.271828,0.209303,0.504434; 0.270595,0.214069,0.507052; 0.269308,0.218818,0.509577; 0.267968,0.223549,0.512008; 
    0.266580,0.228262,0.514349; 0.265145,0.232956,0.516599; 0.263663,0.237631,0.518762; 0.262138,0.242286,0.520837; 0.260571,0.246922,0.522828; 
    0.258965,0.251537,0.524736; 0.257322,0.256130,0.526563; 0.255645,0.260703,0.528312; 0.253935,0.265254,0.529983; 0.252194,0.269783,0.531579; 
    0.250425,0.274290,0.533103; 0.248629,0.278775,0.534556; 0.246811,0.283237,0.535941; 0.244972,0.287675,0.537260; 0.243113,0.292092,0.538516; 
    0.241237,0.296485,0.539709; 0.239346,0.300855,0.540844; 0.237441,0.305202,0.541921; 0.235526,0.309527,0.542944; 0.233603,0.313828,0.543914; 
    0.231674,0.318106,0.544834; 0.229739,0.322361,0.545706; 0.227802,0.326594,0.546532; 0.225863,0.330805,0.547314; 0.223925,0.334994,0.548053; 
    0.221989,0.339161,0.548752; 0.220057,0.343307,0.549413; 0.218130,0.347432,0.550038; 0.216210,0.351535,0.550627; 0.214298,0.355619,0.551184; 
    0.212395,0.359683,0.551710; 0.210503,0.363727,0.552206; 0.208623,0.367752,0.552675; 0.206756,0.371758,0.553117; 0.204903,0.375746,0.553533; 
    0.203063,0.379716,0.553925; 0.201239,0.383670,0.554294; 0.199430,0.387607,0.554642; 0.197636,0.391528,0.554969; 0.195860,0.395433,0.555276; 
    0.194100,0.399323,0.555565; 0.192357,0.403199,0.555836; 0.190631,0.407061,0.556089; 0.188923,0.410910,0.556326; 0.187231,0.414746,0.556547; 
    0.185556,0.418570,0.556753; 0.183898,0.422383,0.556944; 0.182256,0.426184,0.557120; 0.180629,0.429975,0.557282; 0.179019,0.433756,0.557430; 
    0.177423,0.437527,0.557565; 0.175841,0.441290,0.557685; 0.174274,0.445044,0.557792; 0.172719,0.448791,0.557885; 0.171176,0.452530,0.557965; 
    0.169646,0.456262,0.558030; 0.168126,0.459988,0.558082; 0.166617,0.463708,0.558119; 0.165117,0.467423,0.558141; 0.163625,0.471133,0.558148; 
    0.162142,0.474838,0.558140; 0.160665,0.478540,0.558115; 0.159194,0.482237,0.558073; 0.157729,0.485932,0.558013; 0.156270,0.489624,0.557936; 
    0.154815,0.493313,0.557840; 0.153364,0.497000,0.557724; 0.151918,0.500685,0.557587; 0.150476,0.504369,0.557430; 0.149039,0.508051,0.557250;
    0.147607,0.511733,0.557049; 0.146180,0.515413,0.556823; 0.144759,0.519093,0.556572; 0.143343,0.522773,0.556295; 0.141935,0.526453,0.555991;
    0.140536,0.530132,0.555659; 0.139147,0.533812,0.555298; 0.137770,0.537492,0.554906; 0.136408,0.541173,0.554483; 0.135066,0.544853,0.554029;
    0.133743,0.548535,0.553541; 0.132444,0.552216,0.553018; 0.131172,0.555899,0.552459; 0.129933,0.559582,0.551864; 0.128729,0.563265,0.551229; 
    0.127568,0.566949,0.550556; 0.126453,0.570633,0.549841; 0.125394,0.574318,0.549086; 0.124395,0.578002,0.548287; 0.123463,0.581687,0.547445; 
    0.122606,0.585371,0.546557; 0.121831,0.589055,0.545623; 0.121148,0.592739,0.544641; 0.120565,0.596422,0.543611; 0.120092,0.600104,0.542530; 
    0.119738,0.603785,0.541400; 0.119512,0.607464,0.540218; 0.119423,0.611141,0.538982; 0.119483,0.614817,0.537692; 0.119699,0.618490,0.536347; 
    0.120081,0.622161,0.534946; 0.120638,0.625828,0.533488; 0.121380,0.629492,0.531973; 0.122312,0.633153,0.530398; 0.123444,0.636809,0.528763; 
    0.124780,0.640461,0.527068; 0.126326,0.644107,0.525311; 0.128087,0.647749,0.523491; 0.130067,0.651384,0.521608; 0.132268,0.655014,0.519661; 
    0.134692,0.658636,0.517649; 0.137339,0.662252,0.515571; 0.140210,0.665859,0.513427; 0.143303,0.669459,0.511215; 0.146616,0.673050,0.508936; 
    0.150148,0.676631,0.506589; 0.153894,0.680203,0.504172; 0.157851,0.683765,0.501686; 0.162016,0.687316,0.499129; 0.166383,0.690856,0.496502; 
    0.170948,0.694384,0.493803; 0.175707,0.697900,0.491033; 0.180653,0.701402,0.488189; 0.185783,0.704891,0.485273; 0.191090,0.708366,0.482284; 
    0.196571,0.711827,0.479221; 0.202219,0.715272,0.476084; 0.208030,0.718701,0.472873; 0.214000,0.722114,0.469588; 0.220124,0.725509,0.466226; 
    0.226397,0.728888,0.462789; 0.232815,0.732247,0.459277; 0.239374,0.735588,0.455688; 0.246070,0.738910,0.452024; 0.252899,0.742211,0.448284; 
    0.259857,0.745492,0.444467; 0.266941,0.748751,0.440573; 0.274149,0.751988,0.436601; 0.281477,0.755203,0.432552; 0.288921,0.758394,0.428426; 
    0.296479,0.761561,0.424223; 0.304148,0.764704,0.419943; 0.311925,0.767822,0.415586; 0.319809,0.770914,0.411152; 0.327796,0.773980,0.406640; 
    0.335885,0.777018,0.402049; 0.344074,0.780029,0.397381; 0.352360,0.783011,0.392636; 0.360741,0.785964,0.387814; 0.369214,0.788888,0.382914; 
    0.377779,0.791781,0.377939; 0.386433,0.794644,0.372886; 0.395174,0.797475,0.367757; 0.404001,0.800275,0.362552; 0.412913,0.803041,0.357269; 
    0.421908,0.805774,0.351910; 0.430983,0.808473,0.346476; 0.440137,0.811138,0.340967; 0.449368,0.813768,0.335384; 0.458674,0.816363,0.329727; 
    0.468053,0.818921,0.323998; 0.477504,0.821444,0.318195; 0.487026,0.823929,0.312321; 0.496615,0.826376,0.306377; 0.506271,0.828786,0.300362; 
    0.515992,0.831158,0.294279; 0.525776,0.833491,0.288127; 0.535621,0.835785,0.281908; 0.545524,0.838039,0.275626; 0.555484,0.840254,0.269281; 
    0.565498,0.842430,0.262877; 0.575563,0.844566,0.256415; 0.585678,0.846661,0.249897; 0.595839,0.848717,0.243329; 0.606045,0.850733,0.236712; 
    0.616293,0.852709,0.230052; 0.626579,0.854645,0.223353; 0.636902,0.856542,0.216620; 0.647257,0.858400,0.209861; 0.657642,0.860219,0.203082; 
    0.668054,0.861999,0.196293; 0.678489,0.863742,0.189503; 0.688944,0.865448,0.182725; 0.699415,0.867117,0.175971; 0.709898,0.868751,0.169257; 
    0.720391,0.870350,0.162603; 0.730889,0.871916,0.156029; 0.741388,0.873449,0.149561; 0.751884,0.874951,0.143228; 0.762373,0.876424,0.137064; 
    0.772852,0.877868,0.131109; 0.783315,0.879285,0.125405; 0.793760,0.880678,0.120005; 0.804182,0.882046,0.114965; 0.814576,0.883393,0.110347; 
    0.824940,0.884720,0.106217; 0.835270,0.886029,0.102646; 0.845561,0.887322,0.099702; 0.855810,0.888601,0.097452; 0.866013,0.889868,0.095953; 
    0.876168,0.891125,0.095250; 0.886271,0.892374,0.095374; 0.896320,0.893616,0.096335; 0.906311,0.894855,0.098125; 0.916242,0.896091,0.100717;
    0.926106,0.897330,0.104071; 0.935904,0.898570,0.108131; 0.945636,0.899815,0.112838; 0.955300,0.901065,0.118128; 0.964894,0.902323,0.123941;
    0.974417,0.903590,0.130215; 0.983868,0.904867,0.136897; 0.993248,0.906157,0.143936];
vec = linspace(0,257,N+2);
cmap = interp1(1:256,cmap,vec(2:N+1),'linear','extrap');
cmap = max(0,min(1,cmap));
end

function cmap = cmap_plasma()
cmap = [5.03832136e-02,   2.98028976e-02,   5.27974883e-01
     6.35363639e-02,   2.84259729e-02,   5.33123681e-01
     7.53531234e-02,   2.72063728e-02,   5.38007001e-01
     8.62217979e-02,   2.61253206e-02,   5.42657691e-01
     9.63786097e-02,   2.51650976e-02,   5.47103487e-01
     1.05979704e-01,   2.43092436e-02,   5.51367851e-01
     1.15123641e-01,   2.35562500e-02,   5.55467728e-01
     1.23902903e-01,   2.28781011e-02,   5.59423480e-01
     1.32380720e-01,   2.22583774e-02,   5.63250116e-01
     1.40603076e-01,   2.16866674e-02,   5.66959485e-01
     1.48606527e-01,   2.11535876e-02,   5.70561711e-01
     1.56420649e-01,   2.06507174e-02,   5.74065446e-01
     1.64069722e-01,   2.01705326e-02,   5.77478074e-01
     1.71573925e-01,   1.97063415e-02,   5.80805890e-01
     1.78950212e-01,   1.92522243e-02,   5.84054243e-01
     1.86212958e-01,   1.88029767e-02,   5.87227661e-01
     1.93374449e-01,   1.83540593e-02,   5.90329954e-01
     2.00445260e-01,   1.79015512e-02,   5.93364304e-01
     2.07434551e-01,   1.74421086e-02,   5.96333341e-01
     2.14350298e-01,   1.69729276e-02,   5.99239207e-01
     2.21196750e-01,   1.64970484e-02,   6.02083323e-01
     2.27982971e-01,   1.60071509e-02,   6.04867403e-01
     2.34714537e-01,   1.55015065e-02,   6.07592438e-01
     2.41396253e-01,   1.49791041e-02,   6.10259089e-01
     2.48032377e-01,   1.44393586e-02,   6.12867743e-01
     2.54626690e-01,   1.38820918e-02,   6.15418537e-01
     2.61182562e-01,   1.33075156e-02,   6.17911385e-01
     2.67702993e-01,   1.27162163e-02,   6.20345997e-01
     2.74190665e-01,   1.21091423e-02,   6.22721903e-01
     2.80647969e-01,   1.14875915e-02,   6.25038468e-01
     2.87076059e-01,   1.08554862e-02,   6.27294975e-01
     2.93477695e-01,   1.02128849e-02,   6.29490490e-01
     2.99855122e-01,   9.56079551e-03,   6.31623923e-01
     3.06209825e-01,   8.90185346e-03,   6.33694102e-01
     3.12543124e-01,   8.23900704e-03,   6.35699759e-01
     3.18856183e-01,   7.57551051e-03,   6.37639537e-01
     3.25150025e-01,   6.91491734e-03,   6.39512001e-01
     3.31425547e-01,   6.26107379e-03,   6.41315649e-01
     3.37683446e-01,   5.61830889e-03,   6.43048936e-01
     3.43924591e-01,   4.99053080e-03,   6.44710195e-01
     3.50149699e-01,   4.38202557e-03,   6.46297711e-01
     3.56359209e-01,   3.79781761e-03,   6.47809772e-01
     3.62553473e-01,   3.24319591e-03,   6.49244641e-01
     3.68732762e-01,   2.72370721e-03,   6.50600561e-01
     3.74897270e-01,   2.24514897e-03,   6.51875762e-01
     3.81047116e-01,   1.81356205e-03,   6.53068467e-01
     3.87182639e-01,   1.43446923e-03,   6.54176761e-01
     3.93304010e-01,   1.11388259e-03,   6.55198755e-01
     3.99410821e-01,   8.59420809e-04,   6.56132835e-01
     4.05502914e-01,   6.78091517e-04,   6.56977276e-01
     4.11580082e-01,   5.77101735e-04,   6.57730380e-01
     4.17642063e-01,   5.63847476e-04,   6.58390492e-01
     4.23688549e-01,   6.45902780e-04,   6.58956004e-01
     4.29719186e-01,   8.31008207e-04,   6.59425363e-01
     4.35733575e-01,   1.12705875e-03,   6.59797077e-01
     4.41732123e-01,   1.53984779e-03,   6.60069009e-01
     4.47713600e-01,   2.07954744e-03,   6.60240367e-01
     4.53677394e-01,   2.75470302e-03,   6.60309966e-01
     4.59622938e-01,   3.57374415e-03,   6.60276655e-01
     4.65549631e-01,   4.54518084e-03,   6.60139383e-01
     4.71456847e-01,   5.67758762e-03,   6.59897210e-01
     4.77343929e-01,   6.97958743e-03,   6.59549311e-01
     4.83210198e-01,   8.45983494e-03,   6.59094989e-01
     4.89054951e-01,   1.01269996e-02,   6.58533677e-01
     4.94877466e-01,   1.19897486e-02,   6.57864946e-01
     5.00677687e-01,   1.40550640e-02,   6.57087561e-01
     5.06454143e-01,   1.63333443e-02,   6.56202294e-01
     5.12206035e-01,   1.88332232e-02,   6.55209222e-01
     5.17932580e-01,   2.15631918e-02,   6.54108545e-01
     5.23632990e-01,   2.45316468e-02,   6.52900629e-01
     5.29306474e-01,   2.77468735e-02,   6.51586010e-01
     5.34952244e-01,   3.12170300e-02,   6.50165396e-01
     5.40569510e-01,   3.49501310e-02,   6.48639668e-01
     5.46157494e-01,   3.89540334e-02,   6.47009884e-01
     5.51715423e-01,   4.31364795e-02,   6.45277275e-01
     5.57242538e-01,   4.73307585e-02,   6.43443250e-01
     5.62738096e-01,   5.15448092e-02,   6.41509389e-01
     5.68201372e-01,   5.57776706e-02,   6.39477440e-01
     5.73631859e-01,   6.00281369e-02,   6.37348841e-01
     5.79028682e-01,   6.42955547e-02,   6.35126108e-01
     5.84391137e-01,   6.85790261e-02,   6.32811608e-01
     5.89718606e-01,   7.28775875e-02,   6.30407727e-01
     5.95010505e-01,   7.71902878e-02,   6.27916992e-01
     6.00266283e-01,   8.15161895e-02,   6.25342058e-01
     6.05485428e-01,   8.58543713e-02,   6.22685703e-01
     6.10667469e-01,   9.02039303e-02,   6.19950811e-01
     6.15811974e-01,   9.45639838e-02,   6.17140367e-01
     6.20918555e-01,   9.89336721e-02,   6.14257440e-01
     6.25986869e-01,   1.03312160e-01,   6.11305174e-01
     6.31016615e-01,   1.07698641e-01,   6.08286774e-01
     6.36007543e-01,   1.12092335e-01,   6.05205491e-01
     6.40959444e-01,   1.16492495e-01,   6.02064611e-01
     6.45872158e-01,   1.20898405e-01,   5.98867442e-01
     6.50745571e-01,   1.25309384e-01,   5.95617300e-01
     6.55579615e-01,   1.29724785e-01,   5.92317494e-01
     6.60374266e-01,   1.34143997e-01,   5.88971318e-01
     6.65129493e-01,   1.38566428e-01,   5.85582301e-01
     6.69845385e-01,   1.42991540e-01,   5.82153572e-01
     6.74522060e-01,   1.47418835e-01,   5.78688247e-01
     6.79159664e-01,   1.51847851e-01,   5.75189431e-01
     6.83758384e-01,   1.56278163e-01,   5.71660158e-01
     6.88318440e-01,   1.60709387e-01,   5.68103380e-01
     6.92840088e-01,   1.65141174e-01,   5.64521958e-01
     6.97323615e-01,   1.69573215e-01,   5.60918659e-01
     7.01769334e-01,   1.74005236e-01,   5.57296144e-01
     7.06177590e-01,   1.78437000e-01,   5.53656970e-01
     7.10548747e-01,   1.82868306e-01,   5.50003579e-01
     7.14883195e-01,   1.87298986e-01,   5.46338299e-01
     7.19181339e-01,   1.91728906e-01,   5.42663338e-01
     7.23443604e-01,   1.96157962e-01,   5.38980786e-01
     7.27670428e-01,   2.00586086e-01,   5.35292612e-01
     7.31862231e-01,   2.05013174e-01,   5.31600995e-01
     7.36019424e-01,   2.09439071e-01,   5.27908434e-01
     7.40142557e-01,   2.13863965e-01,   5.24215533e-01
     7.44232102e-01,   2.18287899e-01,   5.20523766e-01
     7.48288533e-01,   2.22710942e-01,   5.16834495e-01
     7.52312321e-01,   2.27133187e-01,   5.13148963e-01
     7.56303937e-01,   2.31554749e-01,   5.09468305e-01
     7.60263849e-01,   2.35975765e-01,   5.05793543e-01
     7.64192516e-01,   2.40396394e-01,   5.02125599e-01
     7.68090391e-01,   2.44816813e-01,   4.98465290e-01
     7.71957916e-01,   2.49237220e-01,   4.94813338e-01
     7.75795522e-01,   2.53657797e-01,   4.91170517e-01
     7.79603614e-01,   2.58078397e-01,   4.87539124e-01
     7.83382636e-01,   2.62499662e-01,   4.83917732e-01
     7.87132978e-01,   2.66921859e-01,   4.80306702e-01
     7.90855015e-01,   2.71345267e-01,   4.76706319e-01
     7.94549101e-01,   2.75770179e-01,   4.73116798e-01
     7.98215577e-01,   2.80196901e-01,   4.69538286e-01
     8.01854758e-01,   2.84625750e-01,   4.65970871e-01
     8.05466945e-01,   2.89057057e-01,   4.62414580e-01
     8.09052419e-01,   2.93491117e-01,   4.58869577e-01
     8.12611506e-01,   2.97927865e-01,   4.55337565e-01
     8.16144382e-01,   3.02368130e-01,   4.51816385e-01
     8.19651255e-01,   3.06812282e-01,   4.48305861e-01
     8.23132309e-01,   3.11260703e-01,   4.44805781e-01
     8.26587706e-01,   3.15713782e-01,   4.41315901e-01
     8.30017584e-01,   3.20171913e-01,   4.37835947e-01
     8.33422053e-01,   3.24635499e-01,   4.34365616e-01
     8.36801237e-01,   3.29104836e-01,   4.30905052e-01
     8.40155276e-01,   3.33580106e-01,   4.27454836e-01
     8.43484103e-01,   3.38062109e-01,   4.24013059e-01
     8.46787726e-01,   3.42551272e-01,   4.20579333e-01
     8.50066132e-01,   3.47048028e-01,   4.17153264e-01
     8.53319279e-01,   3.51552815e-01,   4.13734445e-01
     8.56547103e-01,   3.56066072e-01,   4.10322469e-01
     8.59749520e-01,   3.60588229e-01,   4.06916975e-01
     8.62926559e-01,   3.65119408e-01,   4.03518809e-01
     8.66077920e-01,   3.69660446e-01,   4.00126027e-01
     8.69203436e-01,   3.74211795e-01,   3.96738211e-01
     8.72302917e-01,   3.78773910e-01,   3.93354947e-01
     8.75376149e-01,   3.83347243e-01,   3.89975832e-01
     8.78422895e-01,   3.87932249e-01,   3.86600468e-01
     8.81442916e-01,   3.92529339e-01,   3.83228622e-01
     8.84435982e-01,   3.97138877e-01,   3.79860246e-01
     8.87401682e-01,   4.01761511e-01,   3.76494232e-01
     8.90339687e-01,   4.06397694e-01,   3.73130228e-01
     8.93249647e-01,   4.11047871e-01,   3.69767893e-01
     8.96131191e-01,   4.15712489e-01,   3.66406907e-01
     8.98983931e-01,   4.20391986e-01,   3.63046965e-01
     9.01807455e-01,   4.25086807e-01,   3.59687758e-01
     9.04601295e-01,   4.29797442e-01,   3.56328796e-01
     9.07364995e-01,   4.34524335e-01,   3.52969777e-01
     9.10098088e-01,   4.39267908e-01,   3.49610469e-01
     9.12800095e-01,   4.44028574e-01,   3.46250656e-01
     9.15470518e-01,   4.48806744e-01,   3.42890148e-01
     9.18108848e-01,   4.53602818e-01,   3.39528771e-01
     9.20714383e-01,   4.58417420e-01,   3.36165582e-01
     9.23286660e-01,   4.63250828e-01,   3.32800827e-01
     9.25825146e-01,   4.68103387e-01,   3.29434512e-01
     9.28329275e-01,   4.72975465e-01,   3.26066550e-01
     9.30798469e-01,   4.77867420e-01,   3.22696876e-01
     9.33232140e-01,   4.82779603e-01,   3.19325444e-01
     9.35629684e-01,   4.87712357e-01,   3.15952211e-01
     9.37990034e-01,   4.92666544e-01,   3.12575440e-01
     9.40312939e-01,   4.97642038e-01,   3.09196628e-01
     9.42597771e-01,   5.02639147e-01,   3.05815824e-01
     9.44843893e-01,   5.07658169e-01,   3.02433101e-01
     9.47050662e-01,   5.12699390e-01,   2.99048555e-01
     9.49217427e-01,   5.17763087e-01,   2.95662308e-01
     9.51343530e-01,   5.22849522e-01,   2.92274506e-01
     9.53427725e-01,   5.27959550e-01,   2.88883445e-01
     9.55469640e-01,   5.33093083e-01,   2.85490391e-01
     9.57468770e-01,   5.38250172e-01,   2.82096149e-01
     9.59424430e-01,   5.43431038e-01,   2.78700990e-01
     9.61335930e-01,   5.48635890e-01,   2.75305214e-01
     9.63202573e-01,   5.53864931e-01,   2.71909159e-01
     9.65023656e-01,   5.59118349e-01,   2.68513200e-01
     9.66798470e-01,   5.64396327e-01,   2.65117752e-01
     9.68525639e-01,   5.69699633e-01,   2.61721488e-01
     9.70204593e-01,   5.75028270e-01,   2.58325424e-01
     9.71835007e-01,   5.80382015e-01,   2.54931256e-01
     9.73416145e-01,   5.85761012e-01,   2.51539615e-01
     9.74947262e-01,   5.91165394e-01,   2.48151200e-01
     9.76427606e-01,   5.96595287e-01,   2.44766775e-01
     9.77856416e-01,   6.02050811e-01,   2.41387186e-01
     9.79232922e-01,   6.07532077e-01,   2.38013359e-01
     9.80556344e-01,   6.13039190e-01,   2.34646316e-01
     9.81825890e-01,   6.18572250e-01,   2.31287178e-01
     9.83040742e-01,   6.24131362e-01,   2.27937141e-01
     9.84198924e-01,   6.29717516e-01,   2.24595006e-01
     9.85300760e-01,   6.35329876e-01,   2.21264889e-01
     9.86345421e-01,   6.40968508e-01,   2.17948456e-01
     9.87332067e-01,   6.46633475e-01,   2.14647532e-01
     9.88259846e-01,   6.52324832e-01,   2.11364122e-01
     9.89127893e-01,   6.58042630e-01,   2.08100426e-01
     9.89935328e-01,   6.63786914e-01,   2.04858855e-01
     9.90681261e-01,   6.69557720e-01,   2.01642049e-01
     9.91364787e-01,   6.75355082e-01,   1.98452900e-01
     9.91984990e-01,   6.81179025e-01,   1.95294567e-01
     9.92540939e-01,   6.87029567e-01,   1.92170500e-01
     9.93031693e-01,   6.92906719e-01,   1.89084459e-01
     9.93456302e-01,   6.98810484e-01,   1.86040537e-01
     9.93813802e-01,   7.04740854e-01,   1.83043180e-01
     9.94103226e-01,   7.10697814e-01,   1.80097207e-01
     9.94323596e-01,   7.16681336e-01,   1.77207826e-01
     9.94473934e-01,   7.22691379e-01,   1.74380656e-01
     9.94553260e-01,   7.28727890e-01,   1.71621733e-01
     9.94560594e-01,   7.34790799e-01,   1.68937522e-01
     9.94494964e-01,   7.40880020e-01,   1.66334918e-01
     9.94355411e-01,   7.46995448e-01,   1.63821243e-01
     9.94140989e-01,   7.53136955e-01,   1.61404226e-01
     9.93850778e-01,   7.59304390e-01,   1.59091984e-01
     9.93482190e-01,   7.65498551e-01,   1.56890625e-01
     9.93033251e-01,   7.71719833e-01,   1.54807583e-01
     9.92505214e-01,   7.77966775e-01,   1.52854862e-01
     9.91897270e-01,   7.84239120e-01,   1.51041581e-01
     9.91208680e-01,   7.90536569e-01,   1.49376885e-01
     9.90438793e-01,   7.96858775e-01,   1.47869810e-01
     9.89587065e-01,   8.03205337e-01,   1.46529128e-01
     9.88647741e-01,   8.09578605e-01,   1.45357284e-01
     9.87620557e-01,   8.15977942e-01,   1.44362644e-01
     9.86509366e-01,   8.22400620e-01,   1.43556679e-01
     9.85314198e-01,   8.28845980e-01,   1.42945116e-01
     9.84031139e-01,   8.35315360e-01,   1.42528388e-01
     9.82652820e-01,   8.41811730e-01,   1.42302653e-01
     9.81190389e-01,   8.48328902e-01,   1.42278607e-01
     9.79643637e-01,   8.54866468e-01,   1.42453425e-01
     9.77994918e-01,   8.61432314e-01,   1.42808191e-01
     9.76264977e-01,   8.68015998e-01,   1.43350944e-01
     9.74443038e-01,   8.74622194e-01,   1.44061156e-01
     9.72530009e-01,   8.81250063e-01,   1.44922913e-01
     9.70532932e-01,   8.87896125e-01,   1.45918663e-01
     9.68443477e-01,   8.94563989e-01,   1.47014438e-01
     9.66271225e-01,   9.01249365e-01,   1.48179639e-01
     9.64021057e-01,   9.07950379e-01,   1.49370428e-01
     9.61681481e-01,   9.14672479e-01,   1.50520343e-01
     9.59275646e-01,   9.21406537e-01,   1.51566019e-01
     9.56808068e-01,   9.28152065e-01,   1.52409489e-01
     9.54286813e-01,   9.34907730e-01,   1.52921158e-01
     9.51726083e-01,   9.41670605e-01,   1.52925363e-01
     9.49150533e-01,   9.48434900e-01,   1.52177604e-01
     9.46602270e-01,   9.55189860e-01,   1.50327944e-01
     9.44151742e-01,   9.61916487e-01,   1.46860789e-01
     9.41896120e-01,   9.68589814e-01,   1.40955606e-01
     9.40015097e-01,   9.75158357e-01,   1.31325517e-01];
   end

function cmap = cmap_magma()

cmap = [...
   0.001461590960000   0.000466127766000   0.013865520000000
   0.002257640070000   0.001294954310000   0.018331146100000
   0.003279432220000   0.002304529910000   0.023708329100000
   0.004512302220000   0.003490376660000   0.029964705900000
   0.005949769870000   0.004842850000000   0.037129669500000
   0.007587985500000   0.006356136220000   0.044973077400000
   0.009426043900000   0.008021850060000   0.052844356100000
   0.011465433700000   0.009828314860000   0.060749638000000
   0.013707570600000   0.011770591300000   0.068666584300000
   0.016155756600000   0.013840496600000   0.076602666000000
   0.018815367000000   0.016026275300000   0.084584489700000
   0.021691934000000   0.018320125400000   0.092610105000000
   0.024791781400000   0.020714787500000   0.100675555000000
   0.028122815400000   0.023200928400000   0.108786954000000
   0.031695530400000   0.025765116100000   0.116964722000000
   0.035520446800000   0.028397457000000   0.125209396000000
   0.039608487200000   0.031089565200000   0.133515085000000
   0.043829535000000   0.033829988500000   0.141886249000000
   0.048061639100000   0.036606610100000   0.150326989000000
   0.052320438800000   0.039406602000000   0.158841025000000
   0.056614897800000   0.042159892500000   0.167445592000000
   0.060949393000000   0.044794492400000   0.176128834000000
   0.065330180100000   0.047317779600000   0.184891506000000
   0.069763729600000   0.049726466600000   0.193735088000000
   0.074256515200000   0.052016776600000   0.202660374000000
   0.078815003400000   0.054184480100000   0.211667355000000
   0.083445631300000   0.056224936500000   0.220755099000000
   0.088154773000000   0.058133146500000   0.229921611000000
   0.092948691400000   0.059903816700000   0.239163669000000
   0.097833477000000   0.061531441400000   0.248476662000000
   0.102814972000000   0.063010405300000   0.257854400000000
   0.107898679000000   0.064335110200000   0.267288933000000
   0.113094451000000   0.065492035800000   0.276783978000000
   0.118405035000000   0.066479159300000   0.286320656000000
   0.123832651000000   0.067294644900000   0.295879431000000
   0.129380192000000   0.067934926400000   0.305442931000000
   0.135053322000000   0.068391279800000   0.314999890000000
   0.140857952000000   0.068654071000000   0.324537640000000
   0.146785234000000   0.068738232300000   0.334011109000000
   0.152839217000000   0.068636859900000   0.343404450000000
   0.159017511000000   0.068354022500000   0.352688028000000
   0.165308131000000   0.067910868900000   0.361816426000000
   0.171713033000000   0.067305326000000   0.370770827000000
   0.178211730000000   0.066575807300000   0.379497161000000
   0.184800877000000   0.065732438100000   0.387972507000000
   0.191459745000000   0.064818331200000   0.396151969000000
   0.198176877000000   0.063862416600000   0.404008953000000
   0.204934882000000   0.062906619200000   0.411514273000000
   0.211718061000000   0.061991787600000   0.418646741000000
   0.218511590000000   0.061158491800000   0.425391816000000
   0.225302032000000   0.060445184300000   0.431741767000000
   0.232076515000000   0.059888685500000   0.437694665000000
   0.238825991000000   0.059517038400000   0.443255999000000
   0.245543175000000   0.059352438400000   0.448435938000000
   0.252220252000000   0.059414711900000   0.453247729000000
   0.258857304000000   0.059705599800000   0.457709924000000
   0.265446744000000   0.060236875400000   0.461840297000000
   0.271994089000000   0.060993555200000   0.465660375000000
   0.278493300000000   0.061977813600000   0.469190328000000
   0.284951097000000   0.063167626100000   0.472450879000000
   0.291365817000000   0.064553448600000   0.475462193000000
   0.297740413000000   0.066117043200000   0.478243482000000
   0.304080941000000   0.067835345200000   0.480811572000000
   0.310382027000000   0.069702476700000   0.483186340000000
   0.316654235000000   0.071689527200000   0.485380429000000
   0.322899126000000   0.073781950400000   0.487408399000000
   0.329114038000000   0.075971508100000   0.489286796000000
   0.335307503000000   0.078236104500000   0.491024144000000
   0.341481725000000   0.080563507900000   0.492631321000000
   0.347635742000000   0.082946351200000   0.494120923000000
   0.353773161000000   0.085372632900000   0.495501096000000
   0.359897941000000   0.087831177200000   0.496778331000000
   0.366011928000000   0.090314303100000   0.497959963000000
   0.372116205000000   0.092815991700000   0.499053326000000
   0.378210547000000   0.095332294700000   0.500066568000000
   0.384299445000000   0.097854910600000   0.501001964000000
   0.390384361000000   0.100379466000000   0.501864236000000
   0.396466670000000   0.102902194000000   0.502657590000000
   0.402547663000000   0.105419865000000   0.503385761000000
   0.408628505000000   0.107929771000000   0.504052118000000
   0.414708664000000   0.110431177000000   0.504661843000000
   0.420791157000000   0.112920210000000   0.505214935000000
   0.426876965000000   0.115395258000000   0.505713602000000
   0.432967001000000   0.117854987000000   0.506159754000000
   0.439062114000000   0.120298314000000   0.506555026000000
   0.445163096000000   0.122724371000000   0.506900806000000
   0.451270678000000   0.125132484000000   0.507198258000000
   0.457385535000000   0.127522145000000   0.507448336000000
   0.463508291000000   0.129892998000000   0.507651812000000
   0.469639514000000   0.132244819000000   0.507809282000000
   0.475779723000000   0.134577500000000   0.507921193000000
   0.481928997000000   0.136891390000000   0.507988509000000
   0.488088169000000   0.139186217000000   0.508010737000000
   0.494257673000000   0.141462106000000   0.507987836000000
   0.500437834000000   0.143719323000000   0.507919772000000
   0.506628929000000   0.145958202000000   0.507806420000000
   0.512831195000000   0.148179144000000   0.507647570000000
   0.519044825000000   0.150382611000000   0.507442938000000
   0.525269968000000   0.152569121000000   0.507192172000000
   0.531506735000000   0.154739247000000   0.506894860000000
   0.537755194000000   0.156893613000000   0.506550538000000
   0.544015371000000   0.159032895000000   0.506158696000000
   0.550287252000000   0.161157816000000   0.505718782000000
   0.556570783000000   0.163269149000000   0.505230210000000
   0.562865867000000   0.165367714000000   0.504692365000000
   0.569172368000000   0.167454379000000   0.504104606000000
   0.575490107000000   0.169530062000000   0.503466273000000
   0.581818864000000   0.171595728000000   0.502776690000000
   0.588158375000000   0.173652392000000   0.502035167000000
   0.594508337000000   0.175701122000000   0.501241011000000
   0.600868399000000   0.177743036000000   0.500393522000000
   0.607238169000000   0.179779309000000   0.499491999000000
   0.613617209000000   0.181811170000000   0.498535746000000
   0.620005032000000   0.183839907000000   0.497524075000000
   0.626401108000000   0.185866869000000   0.496456304000000
   0.632804854000000   0.187893468000000   0.495331769000000
   0.639215638000000   0.189921182000000   0.494149821000000
   0.645632778000000   0.191951556000000   0.492909832000000
   0.652055535000000   0.193986210000000   0.491611196000000
   0.658483116000000   0.196026835000000   0.490253338000000
   0.664914668000000   0.198075202000000   0.488835712000000
   0.671349279000000   0.200133166000000   0.487357807000000
   0.677785975000000   0.202202663000000   0.485819154000000
   0.684223712000000   0.204285721000000   0.484219325000000
   0.690661380000000   0.206384461000000   0.482557941000000
   0.697097796000000   0.208501100000000   0.480834678000000
   0.703531700000000   0.210637956000000   0.479049270000000
   0.709961888000000   0.212797337000000   0.477201121000000
   0.716387038000000   0.214981693000000   0.475289780000000
   0.722805451000000   0.217193831000000   0.473315708000000
   0.729215521000000   0.219436516000000   0.471278924000000
   0.735615545000000   0.221712634000000   0.469179541000000
   0.742003713000000   0.224025196000000   0.467017774000000
   0.748378107000000   0.226377345000000   0.464793954000000
   0.754736692000000   0.228772352000000   0.462508534000000
   0.761077312000000   0.231213625000000   0.460162106000000
   0.767397681000000   0.233704708000000   0.457755411000000
   0.773695380000000   0.236249283000000   0.455289354000000
   0.779967847000000   0.238851170000000   0.452765022000000
   0.786212372000000   0.241514325000000   0.450183695000000
   0.792426972000000   0.244242250000000   0.447543155000000
   0.798607760000000   0.247039798000000   0.444848441000000
   0.804751511000000   0.249911350000000   0.442101615000000
   0.810854841000000   0.252861399000000   0.439304963000000
   0.816914186000000   0.255894550000000   0.436461074000000
   0.822925797000000   0.259015505000000   0.433572874000000
   0.828885740000000   0.262229049000000   0.430643647000000
   0.834790818000000   0.265539703000000   0.427671352000000
   0.840635680000000   0.268952874000000   0.424665620000000
   0.846415804000000   0.272473491000000   0.421631064000000
   0.852126490000000   0.276106469000000   0.418572767000000
   0.857762870000000   0.279856666000000   0.415496319000000
   0.863320397000000   0.283729003000000   0.412402889000000
   0.868793368000000   0.287728205000000   0.409303002000000
   0.874176342000000   0.291858679000000   0.406205397000000
   0.879463944000000   0.296124596000000   0.403118034000000
   0.884650824000000   0.300530090000000   0.400047060000000
   0.889731418000000   0.305078817000000   0.397001559000000
   0.894700194000000   0.309773445000000   0.393994634000000
   0.899551884000000   0.314616425000000   0.391036674000000
   0.904281297000000   0.319609981000000   0.388136889000000
   0.908883524000000   0.324755126000000   0.385308008000000
   0.913354091000000   0.330051947000000   0.382563414000000
   0.917688852000000   0.335500068000000   0.379915138000000
   0.921884187000000   0.341098112000000   0.377375977000000
   0.925937102000000   0.346843685000000   0.374959077000000
   0.929845090000000   0.352733817000000   0.372676513000000
   0.933606454000000   0.358764377000000   0.370540883000000
   0.937220874000000   0.364929312000000   0.368566525000000
   0.940687443000000   0.371224168000000   0.366761699000000
   0.944006448000000   0.377642889000000   0.365136328000000
   0.947179528000000   0.384177874000000   0.363701130000000
   0.950210150000000   0.390819546000000   0.362467694000000
   0.953099077000000   0.397562894000000   0.361438431000000
   0.955849237000000   0.404400213000000   0.360619076000000
   0.958464079000000   0.411323666000000   0.360014232000000
   0.960949221000000   0.418323245000000   0.359629789000000
   0.963310281000000   0.425389724000000   0.359469020000000
   0.965549351000000   0.432518707000000   0.359529151000000
   0.967671128000000   0.439702976000000   0.359810172000000
   0.969680441000000   0.446935635000000   0.360311120000000
   0.971582181000000   0.454210170000000   0.361030156000000
   0.973381238000000   0.461520484000000   0.361964652000000
   0.975082439000000   0.468860936000000   0.363111292000000
   0.976690494000000   0.476226350000000   0.364466162000000
   0.978209957000000   0.483612031000000   0.366024854000000
   0.979645181000000   0.491013764000000   0.367782559000000
   0.981000291000000   0.498427800000000   0.369734157000000
   0.982279159000000   0.505850848000000   0.371874301000000
   0.983485387000000   0.513280054000000   0.374197501000000
   0.984622298000000   0.520712972000000   0.376698186000000
   0.985692925000000   0.528147545000000   0.379370774000000
   0.986700017000000   0.535582070000000   0.382209724000000
   0.987646038000000   0.543015173000000   0.385209578000000
   0.988533173000000   0.550445778000000   0.388365009000000
   0.989363341000000   0.557873075000000   0.391670846000000
   0.990138201000000   0.565296495000000   0.395122099000000
   0.990871208000000   0.572706259000000   0.398713971000000
   0.991558165000000   0.580106828000000   0.402441058000000
   0.992195728000000   0.587501706000000   0.406298792000000
   0.992784669000000   0.594891088000000   0.410282976000000
   0.993325561000000   0.602275297000000   0.414389658000000
   0.993834412000000   0.609643540000000   0.418613221000000
   0.994308514000000   0.616998953000000   0.422949672000000
   0.994737698000000   0.624349657000000   0.427396771000000
   0.995121854000000   0.631696376000000   0.431951492000000
   0.995480469000000   0.639026596000000   0.436607159000000
   0.995809924000000   0.646343897000000   0.441360951000000
   0.996095703000000   0.653658756000000   0.446213021000000
   0.996341406000000   0.660969379000000   0.451160201000000
   0.996579803000000   0.668255621000000   0.456191814000000
   0.996774784000000   0.675541484000000   0.461314158000000
   0.996925427000000   0.682827953000000   0.466525689000000
   0.997077185000000   0.690087897000000   0.471811461000000
   0.997186253000000   0.697348991000000   0.477181727000000
   0.997253982000000   0.704610791000000   0.482634651000000
   0.997325180000000   0.711847714000000   0.488154375000000
   0.997350983000000   0.719089119000000   0.493754665000000
   0.997350583000000   0.726324415000000   0.499427972000000
   0.997341259000000   0.733544671000000   0.505166839000000
   0.997284689000000   0.740771893000000   0.510983331000000
   0.997228367000000   0.747980563000000   0.516859378000000
   0.997138480000000   0.755189852000000   0.522805996000000
   0.997019342000000   0.762397883000000   0.528820775000000
   0.996898254000000   0.769590975000000   0.534892341000000
   0.996726862000000   0.776794860000000   0.541038571000000
   0.996570645000000   0.783976508000000   0.547232992000000
   0.996369065000000   0.791167346000000   0.553498939000000
   0.996162309000000   0.798347709000000   0.559819643000000
   0.995932448000000   0.805527126000000   0.566201824000000
   0.995680107000000   0.812705773000000   0.572644795000000
   0.995423973000000   0.819875302000000   0.579140130000000
   0.995131288000000   0.827051773000000   0.585701463000000
   0.994851089000000   0.834212826000000   0.592307093000000
   0.994523666000000   0.841386618000000   0.598982818000000
   0.994221900000000   0.848540474000000   0.605695903000000
   0.993865767000000   0.855711038000000   0.612481798000000
   0.993545285000000   0.862858846000000   0.619299300000000
   0.993169558000000   0.870024467000000   0.626189463000000
   0.992830963000000   0.877168404000000   0.633109148000000
   0.992439881000000   0.884329694000000   0.640099465000000
   0.992089454000000   0.891469549000000   0.647116021000000
   0.991687744000000   0.898627050000000   0.654201544000000
   0.991331929000000   0.905762748000000   0.661308839000000
   0.990929685000000   0.912915010000000   0.668481201000000
   0.990569914000000   0.920048699000000   0.675674592000000
   0.990174637000000   0.927195612000000   0.682925602000000
   0.989814839000000   0.934328540000000   0.690198194000000
   0.989433736000000   0.941470354000000   0.697518628000000
   0.989077438000000   0.948604077000000   0.704862519000000
   0.988717064000000   0.955741520000000   0.712242232000000
   0.988367028000000   0.962878026000000   0.719648627000000
   0.988032885000000   0.970012413000000   0.727076773000000
   0.987690702000000   0.977154231000000   0.734536205000000
   0.987386827000000   0.984287561000000   0.742001547000000
   0.987052509000000   0.991437853000000   0.749504188000000];
end

function cmap = cmap_morgan() %r,g,b
ns=128;
rb_pct = 0.3;
g_pct = 0.6;

rb_pt = floor(rb_pct*ns);
g_pt = floor(g_pct*ns);

rb_side = zeros(1,ns);
rb_side(rb_pt:ns) = linspace(0,255,length(rb_pt:ns));

g_side = 255*ones(1,ns);
g_side(1:g_pt) = linspace(0,255,length(1:g_pt));

cmap = zeros(ns*2,3);
cmap(:,1) = [rb_side,repmat(255,1,ns)];  %R
cmap(:,2) = [g_side,g_side(end:-1:1)];  %G
cmap(:,3) = [repmat(255,1,ns),rb_side(end:-1:1)];  %B

cmap = cmap./256;

end

function cmap = cmap_rainbow()
n = 256;
r = [   0   4   9  13  18  22  27  31  36  40  45  50  54  58  61  64  68  69  72  74  77  79  80  82  83  85  84  86  87  88  86  87  87  87  85  84  84  84 ...
    83  79  78  77  76  71  70  68  66  60  58  55  53  46  43  40  36  33  25  21  16  12   4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 ...
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 ...
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 ...
    0   0   0   0   0   0   0   4   8  12  21  25  29  33  42  46  51  55  63  67  72  76  80  89  93  97 101 110 114 119 123 131 135 140 144 153 157 161 ...
    165 169 178 182 187 191 199 203 208 212 221 225 229 233 242 246 250 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 ...
    255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255];

g = [   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 ...
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   4   8  16  21  25  29  38  42  46  51  55  63  67  72 ...
    76  84  89  93  97 106 110 114 119 127 131 135 140 144 152 157 161 165 174 178 182 187 195 199 203 208 216 220 225 229 233 242 246 250 255 255 255 255 ...
    255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 ...
    255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 ...
    255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 250 242 238 233 229 221 216 212 208 199 195 191 187 178 174 170 165 161 153 148 ...
    144 140 131 127 123 119 110 106 102  97  89  85  80  76  72  63  59  55  51  42  38  34  29  21  17  12   8   0];

b = [   0   3   7  10  14  19  23  28  32  38  43  48  53  59  63  68  72  77  81  86  91  95 100 104 109 113 118 122 127 132 136 141 145 150 154 159 163 168 ...
    173 177 182 186 191 195 200 204 209 214 218 223 227 232 236 241 245 250 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 ...
    255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 255 246 242 238 ...
    233 225 220 216 212 203 199 195 191 187 178 174 170 165 157 152 148 144 135 131 127 123 114 110 106 102  97  89  84  80  76  67  63  59  55  46  42  38 ...
    34  25  21  16  12   8   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 ...
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 ...
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0];

cmap = [r;g;b].'/n;

end
function cmap = cmap_blues()
cmap = [255,255,255;
    253,255,255;
    251,255,255;
    249,255,255;
    247,255,255;
    245,255,255;
    243,255,255;
    241,255,255;
    239,255,255;
    236,255,255;
    234,255,255;
    232,255,255;
    230,255,255;
    228,255,255;
    226,255,255;
    224,255,255;
    222,255,255;
    220,255,255;
    218,255,255;
    216,255,255;
    214,255,255;
    212,255,255;
    210,255,255;
    208,255,255;
    206,255,255;
    203,255,255;
    201,255,255;
    199,255,255;
    197,255,255;
    195,255,255;
    193,255,255;
    191,255,255;
    189,255,255;
    187,255,255;
    185,255,255;
    183,255,255;
    181,255,255;
    179,255,255;
    177,255,255;
    175,255,255;
    173,255,255;
    171,255,255;
    168,255,255;
    166,255,255;
    164,255,255;
    162,255,255;
    160,255,255;
    158,255,255;
    156,255,255;
    154,255,255;
    152,255,255;
    150,255,255;
    148,255,255;
    146,255,255;
    144,255,255;
    142,255,255;
    140,255,255;
    138,255,255;
    135,255,255;
    133,255,255;
    131,255,255;
    129,255,255;
    127,255,255;
    125,255,255;
    123,254,255;
    121,252,255;
    119,250,255;
    117,248,255;
    115,246,255;
    113,244,255;
    112,242,255;
    110,240,255;
    108,238,255;
    106,236,255;
    104,234,255;
    102,232,255;
    100,230,255;
    98,228,255;
    96,226,255;
    94,224,255;
    92,222,255;
    90,219,255;
    88,217,255;
    86,215,255;
    84,213,255;
    82,211,255;
    80,209,255;
    79,207,255;
    77,205,255;
    75,203,255;
    73,201,255;
    71,199,255;
    69,197,255;
    67,195,255;
    65,193,255;
    63,191,255;
    61,189,255;
    59,186,255;
    57,184,255;
    55,182,255;
    53,180,255;
    51,178,255;
    49,176,255;
    48,174,255;
    46,172,255;
    44,170,255;
    42,168,255;
    40,166,255;
    38,164,255;
    36,162,255;
    34,160,255;
    32,158,255;
    30,156,255;
    28,154,255;
    26,151,255;
    24,149,255;
    22,147,255;
    20,145,255;
    18,143,255;
    16,141,255;
    15,139,255;
    13,137,255;
    11,135,255;
    9,133,255;
    7,131,255;
    5,129,255;
    3,127,255;
    1,125,255;
    0,123,254;
    0,121,252;
    0,119,250;
    0,117,248;
    0,115,246;
    0,113,244;
    0,111,242;
    0,109,240;
    0,107,237;
    0,105,235;
    0,103,233;
    0,101,231;
    0,99,229;
    0,97,227;
    0,96,225;
    0,94,223;
    0,92,221;
    0,90,219;
    0,88,217;
    0,86,215;
    0,84,213;
    0,82,211;
    0,80,209;
    0,78,207;
    0,76,205;
    0,74,202;
    0,72,200;
    0,70,198;
    0,68,196;
    0,66,194;
    0,64,192;
    0,63,190;
    0,61,188;
    0,59,186;
    0,57,184;
    0,55,182;
    0,53,180;
    0,51,178;
    0,49,176;
    0,47,174;
    0,45,172;
    0,43,169;
    0,41,167;
    0,39,165;
    0,37,163;
    0,35,161;
    0,33,159;
    0,32,157;
    0,30,155;
    0,28,153;
    0,26,151;
    0,24,149;
    0,22,147;
    0,20,145;
    0,18,143;
    0,16,141;
    0,14,139;
    0,12,137;
    0,10,134;
    0,8,132;
    0,6,130;
    0,4,128;
    0,2,126;
    0,0,124;
    0,0,122;
    0,0,120;
    0,0,118;
    0,0,116;
    0,0,114;
    0,0,112;
    0,0,111;
    0,0,109;
    0,0,107;
    0,0,105;
    0,0,103;
    0,0,101;
    0,0,99;
    0,0,97;
    0,0,95;
    0,0,93;
    0,0,91;
    0,0,89;
    0,0,87;
    0,0,85;
    0,0,83;
    0,0,81;
    0,0,80;
    0,0,78;
    0,0,76;
    0,0,74;
    0,0,72;
    0,0,70;
    0,0,68;
    0,0,66;
    0,0,64;
    0,0,62;
    0,0,60;
    0,0,58;
    0,0,56;
    0,0,54;
    0,0,52;
    0,0,50;
    0,0,48;
    0,0,47;
    0,0,45;
    0,0,43;
    0,0,41;
    0,0,39;
    0,0,37;
    0,0,35;
    0,0,33;
    0,0,31;
    0,0,29;
    0,0,27;
    0,0,25;
    0,0,23;
    0,0,21;
    0,0,19;
    0,0,17;
    0,0,16;
    0,0,14;
    0,0,12;
    0,0,10;
    0,0,8;
    0,0,6;
    0,0,4;
    0,0,2;
    0,0,0]./256;
end

function cmap = cmap_cw()
cmap = [    59    76   192
    60    78   194
    61    80   195
    62    81   197
    63    83   198
    64    85   200
    66    87   201
    67    88   203
    68    90   204
    69    92   206
    70    93   207
    71    95   209
    73    97   210
    74    99   211
    75   100   213
    76   102   214
    77   104   215
    79   105   217
    80   107   218
    81   109   219
    82   110   221
    84   112   222
    85   114   223
    86   115   224
    87   117   225
    89   119   226
    90   120   228
    91   122   229
    93   123   230
    94   125   231
    95   127   232
    96   128   233
    98   130   234
    99   131   235
    100   133   236
    102   135   237
    103   136   238
    104   138   239
    106   139   239
    107   141   240
    108   142   241
    110   144   242
    111   145   243
    112   147   243
    114   148   244
    115   150   245
    116   151   246
    118   153   246
    119   154   247
    120   156   247
    122   157   248
    123   158   249
    124   160   249
    126   161   250
    127   163   250
    129   164   251
    130   165   251
    131   167   252
    133   168   252
    134   169   252
    135   171   253
    137   172   253
    138   173   253
    140   174   254
    141   176   254
    142   177   254
    144   178   254
    145   179   254
    147   181   255
    148   182   255
    149   183   255
    151   184   255
    152   185   255
    153   186   255
    155   187   255
    156   188   255
    158   190   255
    159   191   255
    160   192   255
    162   193   255
    163   194   255
    164   195   254
    166   196   254
    167   197   254
    168   198   254
    170   199   253
    171   199   253
    172   200   253
    174   201   253
    175   202   252
    176   203   252
    178   204   251
    179   205   251
    180   205   251
    182   206   250
    183   207   250
    184   208   249
    185   208   248
    187   209   248
    188   210   247
    189   210   247
    190   211   246
    192   212   245
    193   212   245
    194   213   244
    195   213   243
    197   214   243
    198   214   242
    199   215   241
    200   215   240
    201   216   239
    203   216   238
    204   217   238
    205   217   237
    206   217   236
    207   218   235
    208   218   234
    209   219   233
    210   219   232
    211   219   231
    213   219   230
    214   220   229
    215   220   228
    216   220   227
    217   220   225
    218   220   224
    219   220   223
    220   221   222
    221   221   221
    222   220   219
    223   220   218
    224   219   216
    225   219   215
    226   218   214
    227   218   212
    228   217   211
    229   216   209
    230   216   208
    231   215   206
    232   215   205
    232   214   203
    233   213   202
    234   212   200
    235   212   199
    236   211   197
    236   210   196
    237   209   194
    238   209   193
    238   208   191
    239   207   190
    240   206   188
    240   205   187
    241   204   185
    241   203   184
    242   202   182
    242   201   181
    243   200   179
    243   199   178
    244   198   176
    244   197   174
    245   196   173
    245   195   171
    245   194   170
    245   193   168
    246   192   167
    246   191   165
    246   190   163
    246   188   162
    247   187   160
    247   186   159
    247   185   157
    247   184   156
    247   182   154
    247   181   152
    247   180   151
    247   178   149
    247   177   148
    247   176   146
    247   174   145
    247   173   143
    247   172   141
    247   170   140
    247   169   138
    247   167   137
    247   166   135
    246   164   134
    246   163   132
    246   161   131
    246   160   129
    245   158   127
    245   157   126
    245   155   124
    244   154   123
    244   152   121
    244   151   120
    243   149   118
    243   147   117
    242   146   115
    242   144   114
    241   142   112
    241   141   111
    240   139   109
    240   137   108
    239   136   106
    238   134   105
    238   132   103
    237   130   102
    236   129   100
    236   127    99
    235   125    97
    234   123    96
    233   121    95
    233   120    93
    232   118    92
    231   116    90
    230   114    89
    229   112    88
    228   110    86
    227   108    85
    227   106    83
    226   104    82
    225   102    81
    224   100    79
    223    98    78
    222    96    77
    221    94    75
    220    92    74
    218    90    73
    217    88    71
    216    86    70
    215    84    69
    214    82    67
    213    80    66
    212    78    65
    210    75    64
    209    73    62
    208    71    61
    207    69    60
    205    66    59
    204    64    57
    203    62    56
    202    59    55
    200    57    54
    199    54    53
    198    51    52
    196    49    50
    195    46    49
    193    43    48
    192    40    47
    190    37    46
    189    34    45
    188    30    44
    186    26    43
    185    22    41
    183    17    40
    181    11    39
    180     4    38]./256;
end

function cmap = cmap_rb()
cmap = [95 0 0
    97 0 0
    98 0 0
    100 0 0
    101 0 0
    103 0 0
    104 0 0
    106 0 0
    107 0 0
    109 0 0
    110 0 0
    112 0 0
    114 0 0
    115 0 0
    117 0 0
    118 0 0
    120 0 0
    121 0 0
    123 0 0
    124 0 0
    126 0 0
    127 0 0
    129 0 0
    130 0 0
    132 0 0
    134 0 0
    135 0 0
    137 0 0
    138 0 0
    140 0 0
    141 0 0
    143 0 0
    144 0 0
    146 0 0
    147 0 0
    149 0 0
    150 0 0
    152 0 0
    154 0 0
    155 0 0
    157 0 0
    158 0 0
    160 0 0
    161 0 0
    163 0 0
    164 0 0
    166 0 0
    167 0 0
    169 0 0
    170 0 0
    172 0 0
    174 0 0
    175 0 0
    177 0 0
    178 0 0
    180 0 0
    181 0 0
    183 0 0
    184 0 0
    186 0 0
    187 0 0
    189 0 0
    190 0 0
    192 0 0
    193 1 1
    194 5 5
    195 9 9
    196 13 13
    197 17 17
    198 21 21
    199 25 25
    200 29 29
    201 33 33
    202 37 37
    203 41 41
    204 45 45
    205 49 49
    206 53 53
    207 57 57
    208 61 61
    209 65 65
    210 69 69
    211 73 73
    212 77 77
    213 81 81
    214 85 85
    215 89 89
    216 93 93
    217 97 97
    218 101 101
    219 105 105
    220 109 109
    221 113 113
    222 117 117
    223 121 121
    223 125 125
    224 129 129
    225 133 133
    226 137 137
    227 141 141
    228 145 145
    229 149 149
    230 153 153
    231 157 157
    232 161 161
    233 165 165
    234 169 169
    235 173 173
    236 177 177
    237 181 181
    238 185 185
    239 189 189
    240 193 193
    241 197 197
    242 201 201
    243 205 205
    244 209 209
    245 213 213
    246 217 217
    247 221 221
    248 225 225
    249 229 229
    250 233 233
    251 237 237
    252 241 241
    253 245 245
    254 249 249
    255 253 253
    253 253 255
    249 249 254
    245 245 253
    241 241 252
    237 237 251
    233 233 250
    229 229 249
    225 225 248
    221 221 247
    217 217 246
    213 213 245
    209 209 244
    205 205 243
    201 201 242
    197 197 241
    193 193 240
    189 189 239
    185 185 238
    181 181 238
    177 177 237
    173 173 236
    169 169 235
    165 165 234
    161 161 233
    157 157 232
    153 153 231
    149 149 230
    145 145 229
    141 141 228
    137 137 227
    133 133 226
    129 129 225
    125 125 224
    121 121 223
    117 117 222
    113 113 221
    109 109 220
    105 105 220
    101 101 219
    97 97 218
    93 93 217
    89 89 216
    85 85 215
    81 81 214
    77 77 213
    73 73 212
    69 69 211
    65 65 210
    61 61 209
    57 57 208
    53 53 207
    49 49 206
    45 45 205
    41 41 204
    37 37 203
    33 33 203
    29 29 202
    25 25 201
    21 21 200
    17 17 199
    13 13 198
    9 9 197
    5 5 196
    1 1 195
    0 0 194
    0 0 192
    0 0 190
    0 0 189
    0 0 187
    0 0 186
    0 0 184
    0 0 183
    0 0 181
    0 0 179
    0 0 178
    0 0 176
    0 0 175
    0 0 173
    0 0 172
    0 0 170
    0 0 169
    0 0 167
    0 0 165
    0 0 164
    0 0 162
    0 0 161
    0 0 159
    0 0 158
    0 0 156
    0 0 154
    0 0 153
    0 0 151
    0 0 150
    0 0 148
    0 0 147
    0 0 145
    0 0 144
    0 0 142
    0 0 140
    0 0 139
    0 0 137
    0 0 136
    0 0 134
    0 0 133
    0 0 131
    0 0 129
    0 0 128
    0 0 126
    0 0 125
    0 0 123
    0 0 122
    0 0 120
    0 0 119
    0 0 117
    0 0 115
    0 0 114
    0 0 112
    0 0 111
    0 0 109
    0 0 108
    0 0 106
    0 0 104
    0 0 103
    0 0 101
    0 0 100
    0 0 98
    0 0 97
    0 0 95]./256;
end


function cmap = cmap_jet_to_white(num_colors,only_last)
if nargin < 2
    only_last = 0;
end
        
cmap = jet(num_colors);
if only_last
    cmap(1,1:3) = [1 1 1];
else
    iblue = find(ismember(cmap, [0 0 1], 'rows'));
    cmap(1:iblue,1) = linspace(1,0,iblue);
    cmap(1:iblue,2) = linspace(1,0,iblue);
    cmap(1:iblue,3) = 1;
end
end

function cmap = cmap_magma_to_white(nscale)
        
cmap = cmap_magma();
if nscale == 1
    cmap(1,1:3) = [1 1 1];
else
    cmap2 = cmap;
    cmap = zeros(size(cmap2,1)+nscale,3);
    cmap(nscale+1:end,1:3) = cmap2;
    c1 = linspace(1,0,nscale);
    cmap(1:nscale,1:3) = [c1;c1;c1].';
end
end

function cmap = cmap_plasma_to_white(nscale)
        
cmap = cmap_plasma();
if nscale == 1
    cmap(1,1:3) = [1 1 1];
else
    cmap2 = cmap;
    cmap = zeros(size(cmap2,1)+nscale,3);
    cmap(nscale+1:end,1:3) = cmap2;
    c1 = linspace(1,0,nscale);
    cmap(1:nscale,1:3) = [c1;c1;c1].';
end
end

function cmap = cmap_rainbow_to_white(nscale)
cmap = cmap_rainbow;

if nscale == 1
    cmap(1,1:3) = [1 1 1];
else
    cmap2 = cmap;
    cmap = zeros(size(cmap2,1)+nscale,3);
    cmap(nscale+1:end,1:3) = cmap2;
    c1 = linspace(1,0,nscale);
    cmap(1:nscale,1:3) = [c1;c1;c1].';
end
end

function cmap = cmap_tab20()
cmap = [
0.12156862745098039, 0.4666666666666667,  0.7058823529411765
0.6823529411764706,  0.7803921568627451,  0.9098039215686274
1.0,                 0.4980392156862745,  0.054901960784313725
1.0,                 0.7333333333333333,  0.47058823529411764
0.17254901960784313, 0.6274509803921569,  0.17254901960784313
0.596078431372549,   0.8745098039215686,  0.5411764705882353 
0.8392156862745098,  0.15294117647058825, 0.1568627450980392 
1.0,                 0.596078431372549,   0.5882352941176471 
0.5803921568627451,  0.403921568627451,   0.7411764705882353 
0.7725490196078432,  0.6901960784313725,  0.8352941176470589 
0.5490196078431373,  0.33725490196078434, 0.29411764705882354
0.7686274509803922,  0.611764705882353,   0.5803921568627451 
0.8901960784313725,  0.4666666666666667,  0.7607843137254902 
0.9686274509803922,  0.7137254901960784,  0.8235294117647058 
0.4980392156862745,  0.4980392156862745,  0.4980392156862745 
0.7803921568627451,  0.7803921568627451,  0.7803921568627451 
0.7372549019607844,  0.7411764705882353,  0.13333333333333333
0.8588235294117647,  0.8588235294117647,  0.5529411764705883 
0.09019607843137255, 0.7450980392156863,  0.8117647058823529 
0.6196078431372549,  0.8549019607843137,  0.8980392156862745
    ];
    end